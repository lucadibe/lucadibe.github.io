<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Dashboard</title>
    <script data-memberstack-app="TUO_ID_APP_QUI" src="https://static.memberstack.com/scripts/v1/memberstack.js" type="text/javascript"></script>
    <style>
        body { margin: 0; padding: 20px; background-color: #131722; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; color: #e0e0e0; }
        .data-section { max-width: 1600px; margin: 0 auto; background-color: #1e222d; border-radius: 12px; border: 1px solid #2a2e39; overflow: hidden; box-shadow: 0 15px 35px rgba(0,0,0,0.6); }
        .header-panel { padding: 20px; border-bottom: 1px solid #2a2e39; background: #1e222d; display: flex; justify-content: space-between; align-items: flex-start; flex-wrap: wrap; gap: 20px; }
        h2 { margin: 0; font-size: 24px; color: #d1d4dc; letter-spacing: 1px; }
        
        /* Stile per il bottone login */
        .ms-login-btn { background: #2962ff; color: white; padding: 10px 20px; border-radius: 6px; text-decoration: none; font-weight: bold; font-size: 14px; transition: 0.3s; }
        .ms-login-btn:hover { background: #1e4bd8; }

        .info-container { display: flex; flex-direction: column; align-items: flex-end; }
        #status { color: #4caf50; font-weight: bold; font-size: 18px; letter-spacing: 0.5px; }
        
        .signal-stats { display: flex; flex-wrap: wrap; gap: 15px; margin-top: 15px; }
        .stat-box { font-weight: bold; font-size: 13px; text-transform: uppercase; padding: 8px 15px; border-radius: 6px; border: 1px solid rgba(255,255,255,0.1); display: flex; align-items: center; gap: 8px; }
        
        .buy-stat { color: #00ff00; background: rgba(0, 255, 0, 0.1); border-color: rgba(0, 255, 0, 0.2); }
        .sell-stat { color: #ff4444; background: rgba(255, 68, 68, 0.1); border-color: rgba(255, 68, 68, 0.2); }

        .table-container { overflow-x: auto; }
        table { width: 100%; border-collapse: collapse; font-size: 14px; text-align: left; }
        th { position: sticky; top: 0; background: #2a2e39; color: #b2b5be; padding: 15px 12px; cursor: pointer; border-bottom: 2px solid #363a45; font-weight: 600; text-transform: uppercase; font-size: 11px; }
        td { padding: 12px 12px; border-bottom: 1px solid #2a2e39; white-space: nowrap; }
        tr:hover { background-color: #262b3a; }
        
        .filter-row th { background: #1e222d; padding: 8px 12px; cursor: default; }
        .filter-input { width: 100%; background: #131722; border: 1px solid #3d4151; color: #fff; font-size: 11px; padding: 6px; border-radius: 4px; box-sizing: border-box; }
        
        .buy-pill { color: #00ff00; font-weight: bold; background: rgba(0, 255, 0, 0.1); padding: 4px 8px; border-radius: 4px; }
        .sell-pill { color: #ff4444; font-weight: bold; background: rgba(255, 68, 68, 0.1); padding: 4px 8px; border-radius: 4px; }
        .ticker-style { font-weight: bold; color: #2962ff; font-size: 15px; }
        .market-style { color: #8d92a3; font-style: italic; font-size: 13px; }
        .sector-style { color: #b2b5be; font-size: 12px; }
        .pos-var { color: #00ff00; font-weight: 500; }
        .neg-var { color: #ff4444; font-weight: 500; }

        .star-icon { cursor: pointer; font-size: 18px; color: #3d4151; transition: color 0.2s; user-select: none; }
        .star-icon.active { color: #ffca28; }
        .star-cell { text-align: center; }

        .filter-star-toggle { cursor: pointer; font-size: 20px; color: rgba(255,255,255,0.2); transition: all 0.2s; }
        .filter-star-toggle.enabled { color: #ffca28; text-shadow: 0 0 10px rgba(255, 202, 40, 0.5); }
    </style>
</head>
<body>

    <div class="data-section">
        <div class="header-panel">
            <div style="flex: 1;">
                <div style="display: flex; align-items: center; gap: 20px;">
                    <h2>Dashboard</h2>
                    <a href="#/ms/login" class="ms-login-btn">Accedi / Registrati</a>
                </div>
                
                <div class="signal-stats" data-ms-content="premium">
                    <div id="buyCounter" class="stat-box buy-stat">BUY SIGNAL TREND W: 0</div>
                    <div id="sellCounter" class="stat-box sell-stat">SELL SIGNAL TREND W: 0</div>
                    <div id="greenFlip" class="stat-box buy-stat">% GREEN SINCE FLIP W: 0%</div>
                    <div id="redFlip" class="stat-box sell-stat">% RED SINCE FLIP W: 0%</div>
                </div>
            </div>
            
            <div class="info-container">
                <div id="status">‚óè AUTO-UPDATE 4:00 AM Italian time</div>
                <a href="#/ms/profile" style="color: #8d92a3; font-size: 12px; margin-top: 10px;" data-ms-member="email">Il mio account</a>
            </div>
        </div>
        
        <div class="table-container" data-ms-content="premium">
            <table id="mainTable">
                <thead>
                    <tr>
                        <th onclick="handleSort(0)">Ticker</th>
                        <th onclick="handleSort(1)">Markets</th> 
                        <th onclick="handleSort(2)">Sector</th>
                        <th onclick="handleSort(3)">Industry</th>
                        <th onclick="handleSort(4)">Last Price</th>
                        <th onclick="handleSort(5)">Trend W</th>
                        <th onclick="handleSort(6)">Price Since Flip W</th>
                        <th onclick="handleSort(7)">Var % W</th>
                        <th onclick="handleSort(8)">Trend D</th>
                        <th onclick="handleSort(9)">Price Since Flip D</th>
                        <th onclick="handleSort(10)">Var % D</th>
                        <th onclick="handleSort(11)">My Watchlist</th>
                    </tr>
                    <tr class="filter-row">
                        <th><input type="text" class="filter-input" placeholder="üîç Ticker" onkeyup="filterTable()"></th>
                        <th><input type="text" class="filter-input" placeholder="Market..." onkeyup="filterTable()"></th> 
                        <th><input type="text" class="filter-input" placeholder="Sector..." onkeyup="filterTable()"></th>
                        <th><input type="text" class="filter-input" placeholder="Industry..." onkeyup="filterTable()"></th>
                        <th><input type="text" class="filter-input" placeholder="Filter..." onkeyup="filterTable()"></th>
                        <th><input type="text" class="filter-input" placeholder="Filter..." onkeyup="filterTable()"></th>
                        <th><input type="text" class="filter-input" placeholder="Filter..." onkeyup="filterTable()"></th>
                        <th><input type="text" class="filter-input" placeholder="Filter..." onkeyup="filterTable()"></th>
                        <th><input type="text" class="filter-input" placeholder="Filter..." onkeyup="filterTable()"></th>
                        <th><input type="text" class="filter-input" placeholder="Filter..." onkeyup="filterTable()"></th>
                        <th><input type="text" class="filter-input" placeholder="Filter..." onkeyup="filterTable()"></th>
                        <th style="text-align: center;">
                            <span id="watchlistToggle" class="filter-star-toggle" onclick="toggleWatchlistFilter()">‚òÖ</span>
                        </th>
                    </tr>
                </thead>
                <tbody id="tableBody"></tbody>
            </table>
        </div>

        <div data-ms-content="!premium" style="padding: 100px; text-align: center;">
            <h3 style="color: #2962ff;">Area Riservata</h3>
            <p>Registrati o accedi per visualizzare i segnali di trading e le analisi complete.</p>
            <a href="#/ms/signup" class="ms-login-btn">Crea Account Gratuito</a>
        </div>
    </div>

<script>
    // [TUTTO IL TUO CODICE JS ORIGINALE SEGUE QUI SOTTO, INVARIATO]
    const csvUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQdzNpQjqwdqK5ZO16Kd8hlNNtmm31gxOy1AAb49CDXqxMwEOmUpowc9H4rHWPbb9rd874zmOtcDTUo/pub?gid=1410987574&single=true&output=csv';
    // ... restanti funzioni (toggleWatchlistFilter, update, etc.) ...
</script>
</body>
</html>
